# 23.02.24 TIL
## Today Learned

### 빈 생명주기?

스프링을 공부할 때 빈 생명주기에 관해 궁금했었는데 마침 배우게 됐다. 말 그대로 생명주기!! 빈이라는 게 애플리케이션을 띄우고
종료할 때도 계속 띄워져있는 그런 것은 아닐 테니... 스프링에서 관리하지 않는가 ?

만약 계속 띄워져 있다면 장애가 일어날 것이고.. 그래서 객체의 초기화와 종료작업이 필요한 것이다.

**Bean은 객체를 생성한 후에 의존관계를 주입한다.** Spring에서는 어떠한 메서드를 통해서 초기화, 소멸 시점의 메시지를 여러 방법으로
알려주는 기능을 제공한다. 그래서 안전하게 종료할 수 있다!


그래서 순서는 이렇다. Spring 컨테이너가 생성이 되면 우리가 등록했던 Bean이 생성될 것이고, 의존관계가 주입이 될 것이다. 그리고 이 때
초기화 콜백(위에서 말한 것이 이것.)이 일어나고, 애플리케이션을 사용 후 사라지기 전 콜백을 한 번 더 보내준 후 Spring이 종료된다.


Spring에서는 이 빈 생명주기 콜백에서 세 가지의 방법을 지원하는데,
1. 인터페이스사용 (InitializingBean, DisposableBean)
2. Config (설정해놓은 곳에) Bean 옆에다 따로 지정해주는 것
3. @PostConstruct, @PreDestroy

첫 번째 인터페이스의 방식은 아무래도 implements 하다 보니 해당 메서드의 이름이라던지.. 변경이 불가함. 또한 이것은 스프링의
코드이며 스프링에게 온전히 의존하는 것이기 때문에 좋지 못하다.. 애초에 의존관계부터가 좋지 못하다는 것이다. 

두 번째로 설정 정보에 Bean으로 옆에 따로 지정해놓는 것은 무엇이냐면, 초기화 메서드와 종료직전 메서드를 따로 만들어두고
각 메서드들의 이름을 빈 (설정정보 ?)에 등록을 하면 된다. 예를 들어, 각 메서드의 이름을 init, close라 정해두면
@Bean(initMethod = "init", destroyMethod = "close")라 지정하면 위의 첫 번째 방식과 똑같은 기능을 갖는다.
이 방식은 첫 번째 방식과는 다르게 스프링에게 의존하는 것이 아니며 메서드명도 자유자재이다.

destroyMethod는 조금 특이한데, 기본 default값으로 inferred가 되어 있다. 따로 내가 저렇게 지정하지 않고 destroyMethod만 써 둔다면
스프링에서 알아서 close처럼 보이는 것을 찾아서 그것을 사용한다는 것. (추론하다) 엄청 신기함.. 해당 추론 기능을 사용하고 싶지 않다면
destroyMethod = "" 로 쓴다면 가능하다. 하지만 이 방법은 위에서 이야기했듯이 소멸이 안되기 때문에 장애가 일어남.

세 번째로는 스프링에서 Annotation으로 지원하는 방식이다. 각각 @PostConstruct, @PreDestroy를 붙여주면 끝이다. 그럼 나머지 둘과 똑같이
작동한다. 위와 같이 인터페이스를 상속받아 메서드를 만들어줘야하고.. 의존관계 신경도 안 써도 되고.. 이런 것보다 어노테이션 하나만 붙여주면 되기에
아주 편리하다. 그리고 해당 패키지는 spring이 아닌 java이기에 다른 곳에서도 적용이 가능하다. 그나마 단점이라 함은
외부 라이브러리에는 적용이 불가하다는 것. 해당 외부 라이브러리를 써야된다 한다면 @Bean을 쓰는 것이 좋다.(두 번째 방법)

## 느낀 점 ?

## 내일 할 일 ?
Spring 마지막 강의, 코딩테스트, 미니 프로젝트 시작하기!

++ 공부하느라 커밋 시간을 잘못 봤다...